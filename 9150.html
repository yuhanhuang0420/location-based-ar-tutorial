<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<title>GeoAR.js demo</title>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
		<script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
		<script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
		<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
	</head>

	<body style="margin: 0; overflow: hidden;">
		<a-scene vr-mode-ui="enabled: false" embedded arjs="sourceType: webcam; debugUIEnabled: false;">
			<!--<a-entity scale="1 1 1" gltf-model="./assets/pin_yellow.gltf" gps-entity-place="latitude: 23.021935; longitude: 120.232394;"></a-entity>
			<a-entity scale="1 1 1"	gltf-model="./assets/pin_yellow.gltf" gps-entity-place="latitude: 23.016261; longitude: 120.261303;"></a-entity>-->
			<a-camera gps-camera rotation-reader> </a-camera>
		</a-scene>
		
		<select id="list" style="position: absolute; top: 0px; left: 0px; z-index: 10;">
			<option class="drop-down">--Please select--</option>
		</select>

		<script>
			jQuery(document).ready(function(){ 
				$.getJSON( "9177.json", function( data ) {
					let dataLength = data.length;
					for(let i=0; i<dataLength; i++){
						AddEntity(dataLength, data[i].Name, data[i].Lat, data[i].Long);
						//console.log("show: " + data[i].Name);
					};
				});
				let elem = document.querySelector("#list").addEventListener("change", function () {
				console.log(this.options[this.selectedIndex].text);
			});
			//新增entity, text(包含文字內容)及新增下拉式選項
			function AddEntity(length, name, lat, lon){ //length:新增的數量, data:新增的內容
				let reference = document.querySelectorAll('a-entity');
				let referenceNode = reference[reference.length-2];
				let reference2 = document.querySelectorAll('a-entity');
				let referenceNode2 = reference[reference.length-2];
				
				let newEntity = document.createElement('a-entity');
				newEntity.setAttribute('class','CP');
				newEntity.setAttribute('gltf-model','./assets/pin_yellow.gltf');
				newEntity.setAttribute('gps-entity-place','latitude:'+lat+'; longitude:'+lon+';');
				document.querySelector('a-scene').insertBefore(newEntity, referenceNode); //確保entity新增在AR.js環境設定entity之前

				let newText = document.createElement('a-text');
				newText.setAttribute('class','CP');
				newText.setAttribute('value', name);
				newText.setAttribute('align', 'center');
				newText.setAttribute('scale', '1.5 1.5 1.5');
				newText.setAttribute('color', 'yellow');
				newText.setAttribute('look-at', '[gps-camera]');
				newText.setAttribute('gps-entity-place','latitude:'+lat+'; longitude:'+lon+';');
				document.querySelector('a-scene').insertBefore(newText, referenceNode); //確保新增在AR.js環境設定entity之前
				
				let newOption = document.createElement('option');
				newOption.setAttribute('class','drop-down');
				newOption.textContent = name;
				document.querySelector('#list').appendChild(newOption);
			}
		</script>
			
	</body>
</html>
