<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>GeoAR.js demo: outdoor location test(height)</title>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
  </head>
  <body style="margin: 0; overflow: hidden;">
    <a-scene
      vr-mode-ui="enabled: false"
      embedded
      arjs="sourceType: webcam; debugUIEnabled: false;"
    >
		<!--測量系館中心牆角(Project Base Point)gps-entity-place="latitude: 22.9986315; longitude: 120.2200450;"-->
		<a-entity id="1floor"
		rotation="0 0 0"
		scale="1 1 1"
		gltf-model="../assets/cube/cube_1m.gltf"
		></a-entity>
		<a-entity id="2floor"
		rotation="0 0 0"
		scale="1 1 1"
		gltf-model="../assets/cube/cube_1m_yellow.gltf"
		></a-entity>
		<a-entity id="3floor"
		rotation="0 0 0"
		scale="1 1 1"
		gltf-model="../assets/cube/cube_1m_orange.gltf"
		></a-entity>
		<a-entity id="4floor"
		rotation="0 0 0"
		scale="1 1 1"
		gltf-model="../assets/cube/cube_1m_red.gltf"
		></a-entity>
		
      <a-camera gps-camera rotation-reader></a-camera>
	</a-scene>
	
	<script>
		var watchID = navigator.geolocation.watchPosition(function(position) {
			CheckHeight(1,position);CheckHeight(2,position);CheckHeight(3,position);CheckHeight(4,position);
			
			console.log(position.coords.altitude);
		});
		function CheckHeight(num,position){
			var entity = document.querySelector('#'+num+'floor');
			var att = document.createAttribute('position');
			var floor = 0;
			if (num == 1){
				floor = 26.731;
			}else if(num == 2){
				floor = 31.676;
			}else if(num == 3){
				floor = 36.164;
			}else if(num == 4){
				floor = 40.701;
			}
			var height = floor - position.coords.altitude;
      var x = 22.9986315 - position.coords.latitude;
      var z = 120.2200450 - position.coords.longtitude;
			att.value = x+" "+height+" "+z;
			camera.setAttributeNode(att);
		};
	</script>
  </body>
</html>
