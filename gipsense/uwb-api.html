<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>UWB API介接測試</title>
	<!--jquery-->
	<script src="https://code.jquery.com/jquery-3.4.1.js"></script>
</head>

<body style='margin: 0; overflow: hidden;'>
    
	<script>
		const GIPSenseSigninURL = "http://140.116.47.123:8686/gipsense/rest/auth/1.0.0/signin";
		/*$.ajax({
			type: "POST",
			url: GIPSenseSigninURL,
			data: JSON.stringify({
			  "l": null,
			  "p": "!p@ssw0rd",
			  "u": "admin"
			}),
			success: function (result) {
			  console.log(result);
			},
			error: function (thrownError) {
			  console.log(thrownError);
			}
		});*/
		
		function Login(){
			var xhr = new XMLHttpRequest();
			xhr.open('POST', "http://140.116.47.123:8686/gipsense/rest/auth/1.0.0/signin", true);
			xhr.setRequestHeader('Content-type', 'application/json');
			xhr.send(JSON.stringify({"l": null,"p": "!p@ssw0rd","u": "admin"}));
			xhr.onreadystatechange=(e) => {
				// do something to response
				console.log(xhr.responseText);
				//var member = JSON.parse(this.responseText);
				//document.cookie = "username="+member.data.username;
				//console.log(document.cookie);
				//Tag();
			};
		};	
		
		Login();
		document.cookie = "gips_cookie_key_i18n_locale=zh-TW; Max-Age=15552000; Expires=Sat, 26-Mar-2022 05:16:20 GMT; Domain=140.116.47.123:8686";
		document.cookie = "gips_cookie_key_i18n_locale=zh-TW; Max-Age=15552000; Expires=Sat, 26-Mar-2022 05:16:20 GMT; Domain=140.116.47.123:8686";
		document.cookie = "gips_cookie_key_i18n_locale=zh-TW; Max-Age=15552000; Expires=Sat, 26-Mar-2022 05:16:20 GMT; Domain=140.116.47.123:8686";
		document.cookie = "SESSION=YTIyYTkzYjItMjgxNC00NTBiLTgwMTMtODdhODJiZWNkNmRh; Domain=140.116.47.123:8686;";
		//console.log(document.cookie);
		Tag();
		
		function Tag(){
			var xhr2 = new XMLHttpRequest();
			xhr2.open('POST', "http://140.116.47.123:8686/gipsense/rest/1.0.0/tagTrack/positions/byTagId/B217", true);
			xhr2.withCredentials = true;
			xhr2.setRequestHeader('Content-type', 'application/json');
			//xhr2.setRequestHeader('Cookie', 'SESSION=YTIyYTkzYjItMjgxNC00NTBiLTgwMTMtODdhODJiZWNkNmRh;');
			//xhr2.setRequestHeader('Cookie', 'gips_cookie_key_i18n_locale=zh-TW; Max-Age=15552000; Expires=Sat, 26-Mar-2022 05:16:20 GMT;');
			xhr2.send(JSON.stringify({
			  "asc": true,
			  "destEpsg": "epsg:4326",
			  "limit": 1000,
			  "polygonString": null,
			  "queryPeriodDTO": {
				"endTime": "2021-06-15T06:45:30.000Z",
				"excludeEndTime": true,
				"excludeStartTime": true,
				"startTime": "2021-06-15T06:41:00.000Z"
			  },
			  "spaceNames": [
				"NCKU_Geo_1F"
			  ],
			  "start": 0
			}));
			xhr2.onload = function () {
				// do something to response
				console.log(this.responseText);
			};
		};
	</script>
</body>